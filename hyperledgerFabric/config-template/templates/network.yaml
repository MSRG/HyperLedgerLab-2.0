tlsEnabled: {{.Values.fabric_tls_enabled}}
useActualDomains: true
orderer:
  cluster:
    enabled: true

network:
  # used by init script to create genesis block and by peer-org-flow to parse consortiums
  genesisProfile: OrdererGenesis
  # used by init script to create genesis block
  systemChannelID: testchainid

  # defines which organizations will join to which channels
  channels:
  {{- $root := . -}}
  {{- range $channel := .Values.channels }}
    - name: {{ $channel.name }}
    # all peers in these organizations will join the channel
      orgs: [{{- range untilStep 1 (int $root.Values.fabric_num_orgs) 1 -}} Org{{.}}, {{- end }}]
  {{- end }}

  # defines which chaincodes will be installed to which organizations
  chaincodes:
  {{- $root := . -}}
  {{- range $channel := .Values.channels }}
    {{- range $chaincode := $channel.chaincodes }}
    - name: {{ $channel.id }}
      language: {{ $channel.language }}
      orgs: [{{- range untilStep 1 (int $root.Values.fabric_num_orgs) 1 -}} Org{{.}}, {{- end }}]
      channels:
        - name: {{ $channel.name }}
          orgs: [{{- range untilStep 1 (int $root.Values.fabric_num_orgs) 1 -}} Org{{.}}, {{- end }}]
          policy: OR ({{- range untilStep 1 (int $root.Values.fabric_num_orgs) 1 -}} 'Org{{.}}MSP.member', {{- end }})
    {{- end }}
    - name: {{ $channel.name }}
    # all peers in these organizations will join the channel
      orgs: [{{- range untilStep 1 (int $root.Values.fabric_num_orgs) 1 -}} Org{{.}}, {{- end }}]
  {{- end }}